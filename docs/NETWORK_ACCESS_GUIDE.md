# 외부 네트워크 접근 가이드

같은 무선 네트워크에서 다른 기기로 접근하여 테스트하는 방법입니다.

## 문제 해결

### 1. Vite 개발 서버 외부 접근 허용

Vite는 기본적으로 `localhost`에만 바인딩되어 있어 외부 접근이 불가능합니다. 
`vite.config.ts`에 다음 설정이 추가되었습니다:

```typescript
server: {
  host: '0.0.0.0', // 외부 네트워크 접근 허용
  port: 5173,
}
```

### 2. 백엔드 서버 외부 접근 허용

백엔드 서버도 `0.0.0.0`으로 바인딩하도록 수정되었습니다.

### 3. 프론트엔드 API URL 설정

외부 기기에서 접근할 때는 프론트엔드가 백엔드 API를 호출할 수 있도록 
IP 주소를 사용해야 합니다.

**방법 1: 환경 변수 파일 수정**

`frontend/.env.development` 파일에서:

```bash
# 기존 (로컬 전용)
VITE_API_URL=http://localhost:3001

# 외부 접근용으로 변경
VITE_API_URL=http://172.30.29.44:3001
```

변경 후 프론트엔드 서버를 재시작해야 합니다.

**방법 2: 동적 설정 (권장)**

코드에서 동적으로 API URL을 결정하도록 수정할 수 있습니다.

## 서버 재시작 (중요!)

**⚠️ 필수**: 환경 변수 변경 후 반드시 서버를 완전히 종료하고 재시작해야 합니다!

### 1. 기존 서버 완전 종료

```bash
# 프론트엔드 서버 종료
kill $(lsof -ti:5173) 2>/dev/null

# 백엔드 서버 종료
kill $(lsof -ti:3001) 2>/dev/null
```

또는 실행 중인 터미널에서 `Ctrl+C`로 종료

### 2. 서버 재시작

**새 터미널 1 - 프론트엔드:**
```bash
cd frontend
npm run dev
```

**새 터미널 2 - 백엔드:**
```bash
cd backend
npm run dev
```

### 3. 서버 로그 확인

프론트엔드 서버 시작 시 다음 메시지가 **반드시** 보여야 합니다:

```
  VITE v5.0.8  ready in XXX ms

  ➜  Local:   http://localhost:5173/
  ➜  Network: http://172.30.29.44:5173/    ← 이 줄이 중요!
```

**"Network" 줄이 보이지 않으면** 설정이 적용되지 않은 것입니다.

## 접근 방법

1. **같은 무선 네트워크에 연결된 기기에서:**
   - 프론트엔드: `http://172.30.29.44:5173`
   - 백엔드 API: `http://172.30.29.44:3001`

2. **방화벽 확인:**
   - macOS: 시스템 설정 > 네트워크 > 방화벽에서 포트 5173, 3001 허용
   - 또는 터미널에서:
     ```bash
     # 방화벽 상태 확인
     sudo /usr/libexec/ApplicationFirewall/socketfilterfw --getglobalstate
     ```

## 태블릿/다른 기기 접근 문제

**같은 PC에서는 접근되지만 태블릿에서는 안 되는 경우:**

가장 가능성 높은 원인: **macOS 방화벽**

### 해결 방법

1. **시스템 설정 > 네트워크 > 방화벽**
2. **옵션... 클릭**
3. **"들어오는 연결 차단" 해제** 또는
4. **Node.js 앱을 허용 목록에 추가**

자세한 내용: `/docs/FIX_TABLET_ACCESS.md` 참고

## 문제 해결

### Timeout 에러 발생 시

1. **서버가 외부 접근을 허용하는지 확인:**
   ```bash
   # 프론트엔드 서버 로그 확인
   # "Local: http://localhost:5173/" 외에
   # "Network: http://172.30.29.44:5173/" 메시지가 보여야 함
   ```

2. **방화벽 설정 확인:**
   - macOS 방화벽이 포트를 차단하고 있을 수 있습니다
   - 시스템 설정에서 방화벽을 일시적으로 끄거나 포트를 허용

3. **IP 주소 확인:**
   ```bash
   # 현재 IP 주소 확인
   ipconfig getifaddr en0  # Wi-Fi
   ipconfig getifaddr en1  # 이더넷
   ```

4. **네트워크 연결 확인:**
   - 같은 Wi-Fi 네트워크에 연결되어 있는지 확인
   - 방화벽이나 네트워크 보안 정책이 차단하고 있을 수 있음

### CORS 에러 발생 시

백엔드 서버의 CORS 설정이 이미 `origin: true`로 설정되어 있어 
모든 origin을 허용합니다. 추가 설정이 필요하지 않습니다.

## 보안 주의사항

⚠️ **개발 환경에서만 사용하세요!**

- `0.0.0.0` 바인딩은 모든 네트워크 인터페이스에서 접근을 허용합니다
- 프로덕션 환경에서는 반드시 적절한 보안 설정을 해야 합니다
- 방화벽 규칙을 통해 접근을 제한하는 것을 권장합니다
